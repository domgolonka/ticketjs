!function(){function SailsIOClient(io){function TmpSocket(){var boundEvents={};this.on=function(evName,fn){return boundEvents[evName]?boundEvents[evName].push(fn):boundEvents[evName]=[fn],this},this.become=function(actualSocket){for(var evName in boundEvents)for(var i in boundEvents[evName])actualSocket.on(evName,boundEvents[evName][i]);if(actualSocket.requestQueue=this.requestQueue,_isConnected(actualSocket))runRequestQueue(actualSocket);else{var alreadyRanRequestQueue=!1;actualSocket.on("connect",function(){alreadyRanRequestQueue||(runRequestQueue(actualSocket),alreadyRanRequestQueue=!0)})}return actualSocket},this.get=Socket.prototype.get,this.post=Socket.prototype.post,this.put=Socket.prototype.put,this["delete"]=Socket.prototype["delete"],this.request=Socket.prototype.request,this._request=Socket.prototype._request}function LoggerFactory(options){return options=options||{prefix:!0},"object"!=typeof console||"function"!=typeof console.log||"function"!=typeof console.log.bind?function(){}:function(){var args=Array.prototype.slice.call(arguments);if("production"!==io.sails.environment){var PREFIX="";options.prefix&&args.unshift(PREFIX),console.log.bind(console).apply(this,args)}}}function _isConnected(socket){return socket.socket&&socket.socket.connected}function runRequestQueue(socket){var queue=socket.requestQueue;if(queue){for(var i in queue){var isSafeToDereference={}.hasOwnProperty.call(queue,i);isSafeToDereference&&_emitFrom(socket,queue[i])}queue=null}}function jsonp(opts,cb){if(opts=opts||{},"undefined"==typeof window)return cb();var scriptEl=document.createElement("script");window._sailsIoJSConnect=cb,scriptEl.src=opts.url,document.getElementsByTagName("head")[0].appendChild(scriptEl)}function JWR(responseCtx){this.body=responseCtx.body||{},this.headers=responseCtx.headers||{},this.statusCode=responseCtx.statusCode||200}function _emitFrom(socket,requestCtx){var cb=requestCtx.cb;delete requestCtx.cb;var sailsEndpoint=requestCtx.method;socket.emit(sailsEndpoint,requestCtx,function(responseCtx){var body;body=responseCtx.body?responseCtx.body:responseCtx,cb&&cb(body,new JWR(responseCtx))})}if(io=io||_io,!io)throw new Error("`sails.io.js` requires a socket.io client, but `io` was not passed in.");var consolog=LoggerFactory();consolog.noPrefix=LoggerFactory({prefix:!1}),JWR.prototype.toString=function(){return"[ResponseFromSails]  -- Status: "+this.statusCode+"  -- Headers: "+this.headers+"  -- Body: "+this.body},JWR.prototype.toPOJO=function(){return{body:this.body,headers:this.headers,statusCode:this.statusCode}},JWR.prototype.pipe=function(){return new Error("Not implemented yet.")};var Socket=io.SocketNamespace;return Socket.prototype.get=function(url,data,cb){return"function"==typeof data&&(cb=data,data={}),this._request({method:"get",data:data,url:url},cb)},Socket.prototype.post=function(url,data,cb){return"function"==typeof data&&(cb=data,data={}),this._request({method:"post",data:data,url:url},cb)},Socket.prototype.put=function(url,data,cb){return"function"==typeof data&&(cb=data,data={}),this._request({method:"put",data:data,url:url},cb)},Socket.prototype["delete"]=function(url,data,cb){return"function"==typeof data&&(cb=data,data={}),this._request({method:"delete",data:data,url:url},cb)},Socket.prototype.request=function(url,data,cb,method){return"string"==typeof cb&&(method=cb,cb=null),"function"==typeof data&&(cb=data,data={}),this._request({method:method||"get",data:data,url:url},cb)},Socket.prototype._request=function(options,cb){var usage="Usage:\n socket."+(options.method||"request")+"( destinationURL, [dataToSend], [fnToCallWhenComplete] )";if(options=options||{},options.data=options.data||{},options.headers=options.headers||{},options.url=options.url.replace(/^(.+)\/*\s*$/,"$1"),"string"!=typeof options.url)throw new Error("Invalid or missing URL!\n"+usage);var request={method:options.method,data:options.data,url:options.url,headers:options.headers,cb:cb};return _isConnected(this)?void _emitFrom(this,request):(this.requestQueue=this.requestQueue||[],void this.requestQueue.push(request))},io.sails={autoConnect:!0,useCORSRouteToGetCookie:!0,environment:urlThisScriptWasFetchedFrom.match(/(\#production|\.min\.js)/g)?"production":"development"},io.sails._origConnectFn=io.connect,io.connect=function(url,opts){return opts=opts||{},url=url||io.sails.url||void 0,url=url?url.replace(/(\/)$/,""):void 0,"string"!=typeof opts.query?opts.query=SDK_INFO.versionString:opts.query+="&"+SDK_INFO.versionString,io.sails._origConnectFn(url,opts)},io.socket=new TmpSocket,setTimeout(function(){function goAheadAndActuallyConnect(){var actualSocket=io.connect(io.sails.url);io.socket=io.socket.become(actualSocket),io.socket.on("connect",function(){consolog.noPrefix("\n    |>    \n  \\___/  "),consolog("`io.socket` connected successfully.\n (for help, see: http://sailsjs.org/#!documentation/reference/BrowserSDK/BrowserSDK.html)"),io.socket.$events.disconnect||io.socket.on("disconnect",function(){consolog("===================================="),consolog("io.socket was disconnected from Sails."),consolog("Usually, this is due to one of the following reasons:\n -> the server "+(io.sails.url?io.sails.url+" ":"")+"was taken down\n -> your browser lost internet connectivity"),consolog("====================================")}),io.socket.$events.reconnect||io.socket.on("reconnect",function(){var numSecsOffline=io.socket.msSinceConnectionLost/1e3;consolog("io.socket reconnected successfully after being offline for "+numSecsOffline+" seconds.")}),io.socket.$events.reconnecting||io.socket.on("reconnecting",function(msSinceConnectionLost,numAttempts){io.socket.msSinceConnectionLost=msSinceConnectionLost,consolog("io.socket is trying to reconnect to Sails...(attempt #"+numAttempts+")")}),io.socket.$events.error||io.socket.on("error",function(err){consolog("Failed to connect socket (probably due to failed authorization on server)","Error:",err)})})}if(!io.sails.autoConnect)return delete io.socket,io;var isXOrigin=io.sails.url&&!0;if(io.sails.useCORSRouteToGetCookie&&isXOrigin){var xOriginCookieRoute="/__getcookie";"string"==typeof io.sails.useCORSRouteToGetCookie&&(xOriginCookieRoute=io.sails.useCORSRouteToGetCookie);var xOriginCookieURL=io.sails.url+xOriginCookieRoute;if("undefined"!=typeof window)jsonp({url:xOriginCookieURL,method:"GET"},goAheadAndActuallyConnect);else{var mikealsReq=require("request");mikealsReq.get(io.sails.url+xOriginCookieRoute,function(err){return err?void consolog("Failed to connect socket (failed to get cookie)","Error:",err):void goAheadAndActuallyConnect()})}}else goAheadAndActuallyConnect()},0),io}var urlThisScriptWasFetchedFrom=function(){if("object"!=typeof window||"object"!=typeof window.document||"function"!=typeof window.document.getElementsByTagName)return"";var allScriptsCurrentlyInDOM=window.document.getElementsByTagName("script"),thisScript=allScriptsCurrentlyInDOM[allScriptsCurrentlyInDOM.length-1];return thisScript.src}(),CONNECTION_METADATA_PARAMS={version:"__sails_io_sdk_version",platform:"__sails_io_sdk_platform",language:"__sails_io_sdk_language"},SDK_INFO={version:"0.10.0",platform:"undefined"==typeof module?"browser":"node",language:"javascript"};SDK_INFO.versionString=CONNECTION_METADATA_PARAMS.version+"="+SDK_INFO.version+"&"+CONNECTION_METADATA_PARAMS.platform+"="+SDK_INFO.platform+"&"+CONNECTION_METADATA_PARAMS.language+"="+SDK_INFO.language;var _io="undefined"!=typeof io?io:null;return"object"==typeof module&&"undefined"!=typeof module.exports?(module.exports=SailsIOClient,SailsIOClient):SailsIOClient()}();